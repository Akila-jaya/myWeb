<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <title>Customer</title>
</head>

<header>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Home</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="Customers-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Customers</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="Orders-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Orders</button>
        </li>


        <li class="nav-item" role="presentation">
            <button class="nav-link" id="Items-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Items</button>
        </li>

    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">...</div>
        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">...</div>
        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">...</div>
    </div>

</header>
<body>
<main>
    <div>
        <h3 class="ps-4" style="font-family: Arial;">
            <img src="assets/images/cust.png" alt="" width="33" height="33" class="d-inline-block align-text-top">
            Customers
        </h3>
    </div>
</main>

<div class="container">
    <div class="row align-items-start">
        <div class="col">

            <div class="col-12 col-md-5">
                <div class="mb-3">
                    <label class="form-label" for="txtCusID">Customer ID</label>
                    <input class="form-control" id="txtCusID" placeholder="Customer ID" type="text">
                </div>
                <div class="mb-3">
                    <label class="form-label" for="txtCusName">Customer Name</label>
                    <input class="form-control" id="txtCusName" placeholder="Customer Name" type="text">
                </div>
                <div class="mb-3">
                    <label class="form-label" for="txtCusAddress">Customer Address</label>
                    <input class="form-control" id="txtCusAddress" placeholder="Customer Address" type="text">
                </div>
                <div class="mb-3">
                    <label class="form-label" for="txtCusTP">Customer Tp</label>
                    <input class="form-control" id="txtCusTP" placeholder="Customer Tp" type="text">
                </div>
            </div>

        </div>
        <div class="col">
            <form>
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label" id="searchCust">SEARCH CUSTOMER</label>
                    <input  type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter Custome Id">
                    <div id="emailHelp" class="form-text">Enter customer name or NIC to search customer.</div>
                    <button type="Search" class="btn btn-primary" id="btnSearch">Search</button>

                </div>



                <button type="button" class="btn btn-primary">Delete</button>
                <button type="button" class="btn btn-primary">Clear</button>
                <button type="button"  class="btn btn-success" id="btnSaveOrUpdate">Save or Update</button>

            </form>

            <table  class="table table-striped">
                <thead>
                <tr style="background-color: #abffcb">
                    <th scope="col">ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Address</th>
                    <th scope="col">Salary</th>
                </tr>
                </thead>
                <tbody id="customerTable">

                </tbody>
            </table>
        </div>

    </div>

</div>


<script src="assets/jQuery/jquery-3.6.0.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="db/DB.js"></script>

<script>
    $("#btnSaveOrUpdate").click(function () {
        //
        saveCustomer();
        //clearAll();/**/
        loadCustomer();
    });
    function saveCustomer(){


            //gather customer information
            let customerID = $("#txtCusID").val();
            let customerName = $("#txtCusName").val();
            let customerAddress = $("#txtCusAddress").val();
            let customerTP = $("#txtCusTP").val();

           var customerObject={
                      id:customerID,
                      name:customerName,
                      address:customerAddress,
                      salary:customerTP

           };

            /*create a html row*/
            //let row = `<tr><td>${customerID}</td><td>${customerName}</td><td>${customerAddress}</td><td>${customerTP}</td></tr>`;

            customerDB.push(customerObject);

            /*select the table body and append the row */
            //$("#customerTable").append(row);


    }
    function loadCustomer() {
        $("#customerTable").empty();
        for (var i of customerDB){
            let row = `<tr><td>${i.id}</td><td>${i.name}</td><td>${i.address}</td><td>${i.salary}</td></tr>`;
            $("#customerTable").append(row);

            $('#txtCusID,#txtCusName,#txtCusAddress,#txtCusTP').val("");
        }

        $("#customerTable>tr").click(function(){

                 let cusID = $(this).children(":eq(0)").text(); // select first td and get text
                 let cusName = $(this).children(":eq(1)").text();
                 let cusAddress = $(this).children(":eq(2)").text();
                 let cusSalary = $(this).children(":eq(3)").text();

                 console.log(cusID, cusName, cusAddress, cusSalary);
                    $("#txtCusID").val(cusID);
                    $("#txtCusName").val(cusName);
                    $("#txtCusAddress").val(cusAddress);
                    $("#txtCusTP").val(cusSalary);
        });

    }
   /* function clearAll(){
        $("#customerTable").empty();
      //  $('#txtCusID,#txtCusName,#txtCusAddress,#txtCusTP').val("");
    }*/



    $("#txtCusID").focus();

    $("#txtCusID").keydown(function (event) {
        if (event.key == "Enter") {
            $("#txtCusName").focus();
        }
    });


    $("#txtCusName").keydown(function (event) {
        if (event.key == "Enter") {
            $("#txtCusAddress").focus();
        }
    });


    $("#txtCusAddress").keydown(function (event) {
        if (event.key == "Enter") {
            $("#txtCusTP").focus();
        }
    });


    $("#btnSearch").click(function () {

        var id=$("#exampleInputEmail1").val();
        console.log("aaa  "+id);
        var obj=search(id);
        if(obj){
            $("#txtCusID").val(obj.id);
            $("#txtCusName").val(obj.name);
            $("#txtCusAddress").val(obj.address);
            $("#txtCusTP").val(obj.salary);
        }else{
            alert("No Such a Customer");
            $('#txtCusID,#txtCusName,#txtCusAddress,#txtCusTP').val("");
        }
    });


    function search(ids){
        for (var i=0;i<customerDB.length;i++){
            if(customerDB[i].id==ids){
                return customerDB[i];
            }

        }


    }









</script>


</body>
</html>